<ng-template #loginCard>
  <div class="auth-card">
    <div class="d-flex justify-content-end align-items-center">
      <button type="button" class="btn-close close-modal" aria-label="Close" (click)="closeModal()">
      </button>
    </div>


    <div class="logo-section">
      <img src="../../../assets/assets/navbarimg.png" alt="Logo" />
      <h2>Welcome Back</h2>
      <p>Login to your account</p>
    </div>

    <div *ngIf="errorMessage" class="alert alert-danger">
      {{ errorMessage }}
    </div>

    <form [formGroup]="loginForm" (ngSubmit)="login()">

      <div class="form-group">
        <label>Email</label>
        <input type="email" placeholder="you@example.com" formControlName="email" />
        <small *ngIf="loginForm.get('email')?.invalid && loginForm.get('email')?.touched" class="text-danger">
          Enter a valid email
        </small>
      </div>

      <div class="form-group password-group">
        <label>Password</label>
        <input [type]="showPassword ? 'text' : 'password'" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" formControlName="password" />
        <button type="button" class="toggle-password" (click)="togglePassword()">
          {{ showPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}
        </button>
      </div>

      <div class="forgot-password d-flex justify-content-between">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" value="" id="checkCheckedDisabled" formControlName="rememberMe" />
          <label class="form-check-label" for="checkCheckedDisabled">
            Remember me
          </label>
        </div>
        <div><a>Forgot password?</a></div>
      </div>

      <button class="btn primary" type="submit" [disabled]="loginForm.invalid || isLoading">
        {{ isLoading ? 'Logging inâ€¦' : 'Login' }}
      </button>

    </form>

    <div class="divider">or</div>

    <p class="switch-auth">
      Donâ€™t have an account?
      <span (click)="switchToRegister()">Register</span>
    </p>

  </div>
</ng-template>

<!-- If used embedded (header) keep overlay behavior; otherwise render card only (modal) -->
<div *ngIf="embedded" class="modal-overlay" (click)="closeModal()">
  <main class="login-container" (click)="$event.stopPropagation()">
    <ng-container *ngTemplateOutlet="loginCard"></ng-container>
  </main>
</div>

<div *ngIf="!embedded" class="login-modal-content">
  <ng-container *ngTemplateOutlet="loginCard"></ng-container>
</div>

<!-- Close button for modal usage -->
<button *ngIf="!embedded" class="modal-card-close" (click)="closeModal()" aria-label="Close">âœ•</button>
